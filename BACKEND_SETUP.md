# 백엔드 서버 설정 가이드

## 📋 개요

N-AutoPost 앱의 **네이버 블로그 자동 발행 기능**을 사용하려면 백엔드 서버가 필요합니다.

이 서버는 **Playwright**를 사용하여 네이버 로그인부터 블로그 포스팅까지 자동으로 처리합니다.

---

## 🚀 빠른 시작

### 1. 패키지 설치

```bash
npm install
```

또는

```bash
pnpm install
```

---

### 2. 서버 실행

#### **옵션 1: 프론트엔드 + 백엔드 동시 실행** (권장)

```bash
npm run dev:all
```

이 명령은 다음 두 서버를 동시에 실행합니다:
- **프론트엔드**: `http://localhost:3001` (Vite)
- **백엔드**: `http://localhost:3002` (Express + Playwright)

---

#### **옵션 2: 백엔드만 실행**

```bash
npm run dev:server
```

이 명령은 **백엔드 서버만** 실행합니다 (포트 3002).

프론트엔드는 별도로 실행해야 합니다:

```bash
npm run dev
```

---

## 🔧 작동 원리

### **전체 흐름**

```
프론트엔드 (localhost:3001)
  ↓
  "자동 포스팅 시작" 버튼 클릭
  ↓
백엔드 API 호출 (POST /api/auto-publish)
  ↓
백엔드 서버 (localhost:3002)
  ↓
Playwright 브라우저 자동화 시작
  ↓
1. 네이버 로그인
2. 블로그 글쓰기 페이지로 이동
3. 제목 입력 (0.03초 간격)
4. 본문 입력 (0.03초 간격)
5. 발행 버튼 클릭
  ↓
✅ 발행 완료!
```

---

## 📡 API 명세

### **POST /api/auto-publish**

네이버 블로그 자동 발행 API

#### **요청 (Request)**

```json
{
  "naverId": "your_naver_id",
  "naverPw": "your_password",
  "title": "블로그 포스트 제목",
  "body": "블로그 포스트 본문 내용...",
  "imageUrl": "https://example.com/image.jpg" // (선택사항)
}
```

#### **응답 (Response)**

##### **성공 시**

```json
{
  "success": true,
  "message": "블로그 포스트가 성공적으로 발행되었습니다!",
  "postUrl": "https://blog.naver.com/계정명/123456789"
}
```

##### **캡차 감지 시**

```json
{
  "success": false,
  "message": "⚠️ 네이버 캡차가 감지되었습니다. 수동으로 해결해주세요.",
  "captchaDetected": true
}
```

##### **실패 시**

```json
{
  "success": false,
  "message": "자동화 실패: 오류 메시지..."
}
```

---

## ⚠️ 주의사항

### 1. **캡차 (Captcha)**

네이버는 자동화를 감지하면 **캡차**를 표시할 수 있습니다.

캡차가 나타나면:
- 브라우저 창이 열려 있으므로 **수동으로 캡차를 해결**해야 합니다.
- 해결 후 다시 "자동 포스팅 시작" 버튼을 클릭하세요.

### 2. **보안 (Security)**

- 계정 정보는 **서버 메모리에만 임시 저장**됩니다.
- 자동화 완료 후 **즉시 파기**됩니다.
- `.env` 파일에 계정 정보를 저장하지 마세요.

### 3. **타이핑 속도**

개발정의서.md에 명시된 대로:
- **제목 입력**: 한 글자씩 0.03초 간격 (30ms delay)
- **본문 입력**: 줄바꿈 포함하여 한 글자씩 0.03초 간격

---

## 🛠️ 트러블슈팅

### **문제 1: "백엔드 서버 연결 실패"**

**원인**: 백엔드 서버가 실행되지 않았습니다.

**해결**:

```bash
npm run dev:server
```

또는

```bash
npm run dev:all
```

---

### **문제 2: "Playwright 브라우저가 열리지 않음"**

**원인**: Playwright가 제대로 설치되지 않았습니다.

**해결**:

```bash
npx playwright install chromium
```

---

### **문제 3: "캡차가 계속 나타남"**

**원인**: 네이버가 자동화를 감지했습니다.

**해결**:
1. 잠시 대기 (5-10분)
2. 브라우저 쿠키 삭제
3. 수동으로 네이버에 로그인하여 정상 사용자임을 확인

---

## 📚 참고

- **개발정의서**: `개발정의서.md`
- **동작 프로세스**: `동작프로세스.md`
- **트러블슈팅**: `TROUBLESHOOTING.md`
